{% load static %}
<!doctype html>
<html lang="pl">
  <head>
    <meta charset="utf-8">
    <title>{% block title %}ALLSEC Portal{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap 5 z CDN (na start) -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    >

    <!-- Nasz styl (do rozbudowy) -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
  </head>
  <body class="bg-light">

    <!-- TOP BAR -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand fw-bold" href="{% url 'core:dashboard' %}">
          ALLSEC Portal
        </a>

        {% if request.user.is_authenticated %}
          <div class="d-flex align-items-center ms-auto">
            <span class="text-white-50 me-3 small">
              Zalogowano jako:
              <strong>
                {{ request.user.get_full_name|default:request.user.username }}
              </strong>
            </span>
            <form method="post" action="{% url 'logout' %}" class="mb-0">
              {% csrf_token %}
              <button type="submit" class="btn btn-outline-light btn-sm">
                Wyloguj
              </button>
            </form>
          </div>
        {% endif %}

      </div>
    </nav>

    <!-- MAIN LAYOUT -->
    <div class="container-fluid">
      <div class="row">
        <!-- LEFT SIDEBAR -->
        {% with url_name=request.resolver_match.url_name|default:"" %}
        <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-dark text-white sidebar collapse">
          <div class="position-sticky pt-3">
            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link text-white {% if url_name == 'dashboard' %}active{% endif %}" {% if url_name == 'dashboard' %}aria-current="page"{% endif %} href="{% url 'core:dashboard' %}">
                  Dashboard
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-white {% if url_name|slice:':9' == 'workorder' %}active{% endif %}" {% if url_name|slice:':9' == 'workorder' %}aria-current="page"{% endif %} href="{% url 'core:workorder_list' %}">
                  Zlecenia
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-white {% if url_name|slice:':14' == 'service_report' %}active{% endif %}" {% if url_name|slice:':14' == 'service_report' %}aria-current="page"{% endif %} href="{% url 'core:service_report_list' %}">
                  Protoko≈Çy
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-white" href="{% url 'core:site_list' %}">
                  <span class="me-2">üè¢</span> Obiekty
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-white" href="{% url 'core:contact_list' %}">
                  <span class="me-2">üë•</span> Kontakty
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-white" href="{% url 'core:manager_list' %}">
                  <span class="me-2">üè¢</span> ZarzƒÖdcy
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-white" href="#">
                  <span class="me-2">üìä</span> Raporty
                </a>
              </li>
            </ul>
          </div>
        </nav>
        {% endwith %}

        <!-- RIGHT CONTENT -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 py-4">
          {% block content %}
          <!-- Tutaj wchodzƒÖ konkretne strony -->
          {% endblock %}
        </main>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous">
    </script>
  </body>
</html>
